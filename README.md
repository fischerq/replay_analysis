replay_analysis
===============

Some dota2 replay analysis using the clarity library.

Main classes can be found in the package `replay_analysis`.

#Path Extraction

Extracts pathing information from replays (currently everything in data/replays) into an SQLite database. Change the constant in `replay_analysis.PathExtraction` to recalculate existing paths.

Each paths contains the movement of a hero from spawn to death.

A movement path is interpreted as a series of 3D points (x,y,t) that is simplified using the [Ramer–Douglas–Peucker algorithm](http://en.wikipedia.org/wiki/Ramer%E2%80%93Douglas%E2%80%93Peucker_algorithm) to eliminate linear movement. 

The penalty factor for time is chosen as the maximum movement speed 522.

Penalty factor and simplification threshold can be set in path_recognition.Path.  

The database schema is generated by the following SQL commands:

    CREATE TABLE Replays (id integer primary key);
    CREATE TABLE Paths (path_id integer primary key, replay_id integer, unit_id integer, name text);
    CREATE TABLE PathNodes (node_id integer primary key, path integer, x integer, y integer, t real, duration real);
	
#Path Viewer
There is a viewer application for paths stored in the DB implemented in replay_analysis. 

View the next path by pressing `Space` or save the current display to a file by pressing `Enter`.

Sample output(simplification threshold 50, first lives in replay 771088857):
Movement of EternaLEnVy on Shadow Fiend
![Movement of EternaLEnVy on Shadow Fiend](https://github.com/Zera-/replay_analysis/raw/master/0.png)
Movement of b0ne7 on Clockwerk
![Movement of b0ne7 on Clockwerk](https://github.com/Zera-/replay_analysis/raw/master/3.png)
Movement of pieliedie on Sand King
![Movement of pieliedie on Sand King](https://github.com/Zera-/replay_analysis/raw/master/4.png)
Movement of Aui_2000 on Skywrath Mage
![Movement of Aui_2000 on Skywrath Mage](https://github.com/Zera-/replay_analysis/raw/master/6.png)
Movement of SingSing on Mirana
![Movement of SingSing on Mirana](https://github.com/Zera-/replay_analysis/raw/master/40.png)


#Movement Graph
Aggregation of data by position. All scales are linear with cropping to deal with outliers. Currently only a simple color scale and no legends. 

Sample output:

Number of visits (16 games, 0-250 visits)
![Visits graph](https://github.com/Zera-/replay_analysis/raw/master/VisitsGraph.png)
Average stay duration(0-2 seconds)
![Average duration](https://github.com/Zera-/replay_analysis/raw/master/DurationGraph.png)